
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Linear Regression &#8212; Machine Learning for Civil Engineers</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Linear Regression using packages" href="regressionModels.html" />
    <link rel="prev" title="Gradient Descent Methods" href="../optimization/3topic.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/borgcube.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Machine Learning for Civil Engineers</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Machine Learning for Civil Engineers
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson1/lesson1.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson2/lesson2.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson3/lesson3.html">
   Prediction Engines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson4/lesson4.html">
   Classification Engines
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lesson4.1/filetransfer.html">
   Transferring Data Files
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lesson4.1/1filesystems.html">
     File Systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lesson4.1/2readwritecore.html">
     Local Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lesson4.1/3readwriteweb.html">
     Files from the Web (
     <code class="docutils literal notranslate">
      <span class="pre">
       requests.get
      </span>
      <span class="pre">
       ...
      </span>
     </code>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson5/lesson5.html">
   Supervised Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson6/lesson6.html">
   Unsupervised Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson7/lesson7.html">
   Reinforcement Learning
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lesson8/lesson8.html">
   Exploratory Data Analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lesson8/datatypes.html">
     Common Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lesson8/downloading.html">
     Downloading Remote Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lesson8/exploratorydataanalysis.html">
     Exploratory Analysis using Data Summaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lesson8/exploratorydataanalysisvisual.html">
     Exploratory Analysis using Visual Summaries
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson9/lesson9.html">
   Probability Distributions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../optimization/optimization.html">
   Optimization Modeling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../optimization/1topic.html">
     Scheduling Example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../optimization/2topic.html">
     Grid Search Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../optimization/3topic.html">
     Gradient Descent Methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson12/lesson12.html">
   Non-Linear Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../logisticregression/logisticregression.html">
   Logistic Regression and Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson14/lesson14.html">
   K Nearest Neigbor Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson15/lesson15.html">
   Decision Trees and Random Forests
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../neuralnetworks/neuralnetworks.html">
   Neural Networks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../neuralnetworks/deeplearners.html">
     Deep Learners
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lessons/lesson11/lesson11.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flessons/lesson11/lesson11.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/lessons/lesson11/lesson11.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Linear Regression
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prediction-engines-regression-approach">
   Prediction Engines: Regression Approach
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fundamental-questions">
     Fundamental Questions
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#classical-regression-by-normal-equations">
       Classical Regression by Normal Equations
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#where-do-these-normal-equations-come-from">
       Where do these normal equations come from?
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#computational-linear-algebra">
       Computational Linear Algebra
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#what-s-the-value-of-the-computational-linear-algebra">
         What’s the Value of the Computational Linear Algebra ?
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#now-using-numpy">
       Now using numpy
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercises-in-class">
     Exercises (In-Class)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#background">
       Background
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-1">
       Exercise 1
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-2">
       Exercise-2
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-3">
     Exercise-3
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-4">
     Exercise-4
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-5">
     Exercise-5
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#change-to-markdown-and-write-your-answer">
   change to markdown and write your answer
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-5-continued">
     Exercise-5 (continued)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#concrete-strength-database">
     Concrete Strength Database
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#topic">
     topic
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#subtopic">
       Subtopic
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#references">
     References
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="linear-regression">
<h1>Linear Regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="prediction-engines-regression-approach">
<h1>Prediction Engines: Regression Approach<a class="headerlink" href="#prediction-engines-regression-approach" title="Permalink to this headline">¶</a></h1>
<p>Regression is a basic and commonly used type of predictive analysis.<br />
The overall idea of regression is to assess:</p>
<ul class="simple">
<li><p>does a set of predictor/explainatory variables (features) do a good job in predicting an outcome (dependent/response) variable?</p></li>
<li><p>Which explainatory variables (features) in particular are significant predictors of the outcome variable, and in what way do they–indicated by the magnitude and sign of the beta estimates–impact the outcome variable?</p></li>
<li><p>What is the estimated(predicted) value of the response under various excitation (explainatory) variable values?</p></li>
<li><p>What is the uncertainty involved in the prediction?</p></li>
</ul>
<p>These regression estimates are used to explain the relationship between one dependent variable and one or more independent variables.</p>
<p>The simplest form is a linear regression equation with one dependent(response) and one independent(explainatory) variable is defined by the formula</p>
<p><span class="math notranslate nohighlight">\(y_i = \beta_0 + \beta_1*x_i\)</span>, where <span class="math notranslate nohighlight">\(y_i\)</span> = estimated dependent(response) variable value, <span class="math notranslate nohighlight">\(\beta_0\)</span> = constant(intercept), <span class="math notranslate nohighlight">\(\beta_1\)</span> = regression coefficient (slope), and <span class="math notranslate nohighlight">\(x_i\)</span> = independent(predictor) variable value</p>
<div class="section" id="fundamental-questions">
<h2>Fundamental Questions<a class="headerlink" href="#fundamental-questions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>What is regression used for?</p></li>
<li><p>Why is it useful?</p></li>
</ul>
<p>Three major uses for regression analysis are (1) determining the strength of predictors, (2) forecasting an effect, and (3) trend forecasting.</p>
<blockquote>
<div><p>First, the regression might be used to identify the strength of the effect that the independent variable(s) have on a dependent variable.  Typical questions are what is the strength of relationship between dose and effect, sales and marketing spending, or age and income.
<br><br>Second, it can be used to forecast effects or impact of changes.  That is, the regression analysis helps us to understand how much the dependent variable changes with a change in one or more independent variables.  A typical question is, “how much additional sales income do I get for each additional $1000 spent on marketing?”
<br><br>Third, regression analysis predicts trends and future values.  The regression analysis can be used to get point estimates.  A typical question is, “what will the price of gold be in 6 months?”</p>
</div></blockquote>
<p>Consider the image below from a Texas Instruments Calculator user manual</p>
<p><img alt="" src="../../_images/ti-manual.png" /></p>
<p>In the context of our class, the straight solid line is the <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Model</span></code> whose equation structure is
<span class="math notranslate nohighlight">\(Y = \beta_0 + \beta_1*X\)</span>.
The ordered pairs <span class="math notranslate nohighlight">\((x_i,y_i)\)</span> in the scatterplot are the observation (or training set).
As depicted here <span class="math notranslate nohighlight">\(Y\)</span> is the response to different values of the  feature (explainitory variable) <span class="math notranslate nohighlight">\(X\)</span>. The typical convention is response on the up-down axis, but not always.</p>
<p>The model parameters are <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> ; once known can estimate (predict) response to (as yet) unobserved values of <span class="math notranslate nohighlight">\(x\)</span></p>
<p>Classically, the normal equations are evaluated to find the model parameters:</p>
<p><span class="math notranslate nohighlight">\(\beta_1 = \frac{\sum x\sum y~-~N\sum xy}{(\sum x)^2~-~N\sum x^2}\)</span> and <span class="math notranslate nohighlight">\(\beta_0 = \bar y - \beta_1 \bar x\)</span></p>
<blockquote>
<div><p>Recall from our earlier discussions, we can dispense with the normal equations and if we have a way to update guesses of <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> we can simple yell at the machine <strong>Learn dammit</strong> and choose the best values of <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> that minimize our metric function value.  Use of calculus in this instance greatly speeds up this process.</p>
</div></blockquote>
<div class="section" id="classical-regression-by-normal-equations">
<h3>Classical Regression by Normal Equations<a class="headerlink" href="#classical-regression-by-normal-equations" title="Permalink to this headline">¶</a></h3>
<p>We will illustrate the classical approach to finding the slope and intercept using the normal equations first a plotting function, then we will use the values from the Texas Instruments TI-55 user manual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Lets Make a Plotting Package</span>

<span class="k">def</span> <span class="nf">makeAbear</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span><span class="n">yvalues</span><span class="p">,</span><span class="n">xleft</span><span class="p">,</span><span class="n">yleft</span><span class="p">,</span><span class="n">xright</span><span class="p">,</span><span class="n">yright</span><span class="p">,</span><span class="n">xlab</span><span class="p">,</span><span class="n">ylab</span><span class="p">,</span><span class="n">title</span><span class="p">):</span>
<span class="c1"># plotting function dependent on matplotlib installed above </span>
<span class="c1"># xvalues, yvalues == data pairs to scatterplot; FLOAT</span>
<span class="c1"># xleft,yleft == left endpoint line to draw; FLOAT</span>
<span class="c1"># xright,yright == right endpoint line to draw; FLOAT</span>
<span class="c1"># xlab,ylab == axis labels, STRINGS!!</span>
<span class="c1"># title == Plot title, STRING</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> 
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xvalues</span><span class="p">,</span><span class="n">yvalues</span><span class="p">)</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xleft</span><span class="p">,</span> <span class="n">xright</span><span class="p">],</span> <span class="p">[</span><span class="n">yleft</span><span class="p">,</span> <span class="n">yright</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlab</span><span class="p">)</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylab</span><span class="p">)</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make two lists</span>
<span class="n">sample_length</span> <span class="o">=</span> <span class="p">[</span><span class="mf">101.3</span><span class="p">,</span><span class="mf">103.7</span><span class="p">,</span><span class="mf">98.6</span><span class="p">,</span><span class="mf">99.9</span><span class="p">,</span><span class="mf">97.2</span><span class="p">,</span><span class="mf">100.1</span><span class="p">]</span>
<span class="n">sample_weight</span> <span class="o">=</span> <span class="p">[</span><span class="mi">609</span><span class="p">,</span><span class="mi">626</span><span class="p">,</span><span class="mi">586</span><span class="p">,</span><span class="mi">594</span><span class="p">,</span><span class="mi">579</span><span class="p">,</span><span class="mi">605</span><span class="p">]</span>
<span class="c1"># We will assume weight is the explainatory variable, and it is to be used to predict length.</span>
<span class="n">makeAbear</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">sample_length</span><span class="p">,</span><span class="mi">580</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">630</span><span class="p">,</span><span class="mi">106</span><span class="p">,</span><span class="s1">&#39;Weight (g)&#39;</span><span class="p">,</span><span class="s1">&#39;Length (cm)&#39;</span><span class="p">,</span><span class="s1">&#39;Length versus Weight for </span><span class="se">\n</span><span class="s1"> NASA CF0132 Fiber Reinforced Polymer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_6_0.png" src="../../_images/lesson11_6_0.png" />
</div>
</div>
<p>Notice the dashed line, we supplied only two (x,y) pairs to plot the line, so lets get a colonoscope and find where it came from.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">myline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="n">value1</span><span class="p">,</span><span class="n">value2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns a tuple ([x1,x2],[y1,y2]) from y=slope*value+intercept&#39;&#39;&#39;</span>
    <span class="n">listy</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">listx</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">listx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value1</span><span class="p">)</span>
    <span class="n">listx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value2</span><span class="p">)</span>
    <span class="n">listy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="o">*</span><span class="n">listx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">intercept</span><span class="p">)</span>
    <span class="n">listy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slope</span><span class="o">*</span><span class="n">listx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">intercept</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">listx</span><span class="p">,</span><span class="n">listy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.13</span>  <span class="c1">#0.13</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">22</span> <span class="c1"># 23</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="mi">580</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="mi">630</span>
<span class="nb">object</span> <span class="o">=</span> <span class="n">myline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="n">xlow</span><span class="p">,</span><span class="n">xhigh</span><span class="p">)</span>
<span class="n">xone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">xtwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">yone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">ytwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">makeAbear</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">sample_length</span><span class="p">,</span><span class="n">xone</span><span class="p">,</span><span class="n">yone</span><span class="p">,</span><span class="n">xtwo</span><span class="p">,</span><span class="n">ytwo</span><span class="p">,</span><span class="s1">&#39;Weight (g)&#39;</span><span class="p">,</span><span class="s1">&#39;Length (cm)&#39;</span><span class="p">,</span><span class="s1">&#39;Length versus Weight for </span><span class="se">\n</span><span class="s1"> NASA CF0132 Fiber Reinforced Polymer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_9_0.png" src="../../_images/lesson11_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">xone</span><span class="p">,</span><span class="n">yone</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xtwo</span><span class="p">,</span><span class="n">ytwo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>580 97.4
630 103.9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evaluate the normal equations</span>
<span class="n">sumx</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">sumy</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">sumxy</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">sumx2</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">sumy2</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)):</span>
    <span class="n">sumx</span> <span class="o">=</span> <span class="n">sumx</span> <span class="o">+</span> <span class="n">sample_weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">sumx2</span> <span class="o">=</span> <span class="n">sumx2</span> <span class="o">+</span> <span class="n">sample_weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">sumy</span> <span class="o">=</span> <span class="n">sumy</span> <span class="o">+</span> <span class="n">sample_length</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">sumy2</span> <span class="o">=</span> <span class="n">sumy2</span> <span class="o">+</span> <span class="n">sample_length</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">sumxy</span> <span class="o">=</span> <span class="n">sumxy</span> <span class="o">+</span> <span class="n">sample_weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sample_length</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">b1</span> <span class="o">=</span> <span class="p">(</span><span class="n">sumx</span><span class="o">*</span><span class="n">sumy</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span><span class="o">*</span><span class="n">sumxy</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">sumx</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span><span class="o">*</span><span class="n">sumx2</span><span class="p">)</span>
<span class="n">b0</span> <span class="o">=</span> <span class="n">sumy</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_length</span><span class="p">)</span> <span class="o">-</span> <span class="n">b1</span><span class="o">*</span> <span class="p">(</span><span class="n">sumx</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">))</span>
<span class="n">lineout</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Linear Model is y=</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">b1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;x + </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">b0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Linear Model is y=</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">b1</span> <span class="p">,</span><span class="s2">&quot;x + </span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">b0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear Model is y=0.129 x + 22.813
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.129</span>  <span class="c1">#0.129</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mf">22.813</span>  <span class="c1"># 22.813</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="mi">580</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="mi">630</span>
<span class="nb">object</span> <span class="o">=</span> <span class="n">myline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="n">xlow</span><span class="p">,</span><span class="n">xhigh</span><span class="p">)</span>
<span class="n">xone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">xtwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">yone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">ytwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">makeAbear</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">sample_length</span><span class="p">,</span><span class="n">xone</span><span class="p">,</span><span class="n">yone</span><span class="p">,</span><span class="n">xtwo</span><span class="p">,</span><span class="n">ytwo</span><span class="p">,</span><span class="s1">&#39;Weight (g)&#39;</span><span class="p">,</span><span class="s1">&#39;Length (cm)&#39;</span><span class="p">,</span><span class="s1">&#39;Length versus Weight for </span><span class="se">\n</span><span class="s1"> NASA CF0132 Fiber Reinforced Polymer&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_12_0.png" src="../../_images/lesson11_12_0.png" />
</div>
</div>
</div>
<div class="section" id="where-do-these-normal-equations-come-from">
<h3>Where do these normal equations come from?<a class="headerlink" href="#where-do-these-normal-equations-come-from" title="Permalink to this headline">¶</a></h3>
<p>Consider our linear model <span class="math notranslate nohighlight">\(y = \beta_0 + \beta_1 \cdot x + \epsilon\)</span>. Where <span class="math notranslate nohighlight">\(\epsilon\)</span> is the error in the estimate. If we square each error and add them up (for our training set) we will have <span class="math notranslate nohighlight">\(\sum \epsilon^2 = \sum (y_i - \beta_0 - \beta_1 \cdot x_i)^2 \)</span>.  Our goal is to minimize this error by our choice of <span class="math notranslate nohighlight">\(\beta_0 \)</span> and <span class="math notranslate nohighlight">\( \beta_1 \)</span></p>
<p>The necessary and sufficient conditions for a minimum is that the first partial derivatives of the <code class="docutils literal notranslate"><span class="pre">error</span></code> as a function must vanish (be equal to zero).  We can leverage that requirement as</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial(\sum \epsilon^2)}{\partial \beta_0} = \frac{\partial{\sum (y_i - \beta_0 - \beta_1 \cdot x_i)^2}}{\partial \beta_0} = - \sum 2[y_i - \beta_0 + \beta_1 \cdot x_i] = -2(\sum_{i=1}^n y_i - n \beta_0 - \beta_1 \sum_{i=1}^n x_i) = 0 \)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial(\sum \epsilon^2)}{\partial \beta_1} = \frac{\partial{\sum (y_i - \beta_0 - \beta_1 \cdot x_i)^2}}{\partial \beta_1} = - \sum 2[y_i - \beta_0 + \beta_1 \cdot x_i]x_i = -2(\sum_{i=1}^n x_i y_i - n \beta_0 \sum_{i=1}^n x_i - \beta_1 \sum_{i=1}^n x_i^2) = 0 \)</span></p>
<p>Solving the two equations for <span class="math notranslate nohighlight">\(\beta_0\)</span> and <span class="math notranslate nohighlight">\(\beta_1\)</span> produces the normal equations (for linear least squares), which leads to</p>
<p><span class="math notranslate nohighlight">\(\beta_1 = \frac{\sum x\sum y~-~n\sum xy}{(\sum x)^2~-~n\sum x^2}\)</span>
<span class="math notranslate nohighlight">\(\beta_0 = \bar y - \beta_1 \bar x\)</span></p>
<blockquote>
<div><p>Now lets convince ourselves that our <strong>Learn dammit</strong> approach will work about the same.  Below we will just grid search, but a better way would involve some way to update the parameters based on the current quality function.  Also we have leveraged our apriori knowledge of the range of values to search.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># identify, collect, load data</span>

<span class="c1"># sample_weight == predictor</span>
<span class="c1"># sample_length == response</span>
<span class="n">input1</span> <span class="o">=</span> <span class="n">sample_weight</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">sample_length</span>
<span class="c1"># a prediction engine structure (notice some logic to handle zeros)</span>
<span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="n">beta1</span><span class="p">,</span><span class="n">beta2</span><span class="p">,</span><span class="n">predictor1</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">beta1</span><span class="o">+</span><span class="n">beta2</span><span class="o">*</span><span class="n">predictor1</span>
    <span class="k">return</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="c1"># a measure of model quality</span>
<span class="k">def</span> <span class="nf">quality</span><span class="p">(</span><span class="n">observed_list</span><span class="p">,</span><span class="n">model_list</span><span class="p">):</span> 
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_list</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;List lengths incompatable&quot;</span><span class="p">)</span>
    <span class="n">sse</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">howmany</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">observed_list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howmany</span><span class="p">):</span>
        <span class="n">sse</span><span class="o">=</span><span class="n">sse</span> <span class="o">+</span> <span class="p">(</span><span class="n">observed_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">model_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>
<span class="c1"># define search region </span>
<span class="n">index_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1900</span><span class="p">,</span><span class="mi">2400</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># index list1 is 19 - 24 in steps of 0.01</span>
<span class="n">index_list2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># index list2 is 0 - 2 in steps of 0.001</span>
<span class="n">howmany</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># keep count of how many combinations</span>
<span class="n">error</span>   <span class="o">=</span> <span class="mf">1e99</span>          <span class="c1"># a big value, we are trying to drive this to zero</span>
<span class="n">xbest</span>   <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># variables to store our best solution parameters</span>
<span class="n">modeloutput</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">))]</span> <span class="c1"># space to store model responses</span>


<span class="c1"># perform a search - here we use nested repetition</span>
<span class="k">for</span> <span class="n">i1</span> <span class="ow">in</span> <span class="n">index_list1</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i2</span> <span class="ow">in</span> <span class="n">index_list2</span><span class="p">:</span>
        <span class="n">howmany</span><span class="o">=</span><span class="n">howmany</span><span class="o">+</span><span class="mi">1</span> <span class="c1"># keep count of how many times we learn</span>
        <span class="n">beta1</span> <span class="o">=</span> <span class="n">i1</span><span class="o">/</span><span class="mi">100</span>
        <span class="n">beta2</span> <span class="o">=</span> <span class="n">i2</span><span class="o">/</span><span class="mi">1000</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span> 
            <span class="n">modeloutput</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span><span class="o">=</span><span class="n">response</span><span class="p">(</span><span class="n">beta1</span><span class="p">,</span><span class="n">beta2</span><span class="p">,</span><span class="n">input1</span><span class="p">[</span><span class="n">irow</span><span class="p">])</span>
        <span class="n">guess</span> <span class="o">=</span> <span class="n">quality</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">modeloutput</span><span class="p">)</span> <span class="c1"># current model quality</span>
 <span class="c1">#               print(guess)</span>
        <span class="k">if</span> <span class="n">guess</span> <span class="o">&lt;=</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">guess</span>
            <span class="n">xbest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span> <span class="n">beta1</span>
            <span class="n">xbest</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="n">beta2</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Search Complete - Error Value &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Combinations Examined : &quot;</span><span class="p">,</span><span class="n">howmany</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Beta 1 &quot;</span><span class="p">,</span><span class="n">xbest</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Beta 2 &quot;</span><span class="p">,</span><span class="n">xbest</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Search Complete - Error Value  0.919755
Combinations Examined :  1000000
Beta 1  22.75
Beta 2  0.129
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)):</span> 
    <span class="n">modeloutput</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span><span class="o">=</span><span class="n">response</span><span class="p">(</span><span class="n">xbest</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xbest</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">input1</span><span class="p">[</span><span class="n">irow</span><span class="p">])</span>

<span class="c1"># now the plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># the python plotting library</span>
<span class="n">plottitle</span> <span class="o">=</span><span class="s1">&#39;Simple Prediction Engine - Automated Learning </span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">plottitle</span> <span class="o">=</span> <span class="n">plottitle</span> <span class="o">+</span> <span class="s1">&#39;Model Error =&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">plottitle</span> <span class="o">=</span> <span class="n">plottitle</span> <span class="o">+</span> <span class="s1">&#39;Beta =&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">xbest</span><span class="p">)</span>
<span class="n">mydata</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># build a square drawing canvass from figure class</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">modeloutput</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Model Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Observed Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Observed Instances&#39;</span><span class="p">,</span><span class="s1">&#39;Prediction Engine&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">plottitle</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_16_0.png" src="../../_images/lesson11_16_0.png" />
</div>
</div>
<p>Lets consider a more flexible way by fitting the data model using linear algebra instead of the summation notation.</p>
</div>
<div class="section" id="computational-linear-algebra">
<h3>Computational Linear Algebra<a class="headerlink" href="#computational-linear-algebra" title="Permalink to this headline">¶</a></h3>
<p>We will start again with our linear data model</p>
<p><span class="math notranslate nohighlight">\(y_i = \beta_0 + \beta_1 \cdot x_i + \epsilon_i\)</span>  then replace with vectors as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather}
\mathbf{Y}=
\begin{pmatrix}
y_1 \\
y_2 \\
\vdots \\
y_n \\
\end{pmatrix}
\end{gather}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather}
\mathbf{\beta}=
\begin{pmatrix}
\beta_0 \\
\beta_1 \\
\end{pmatrix}
\end{gather}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather}
\mathbf{X}=
\begin{pmatrix}
1 &amp; x_1 &amp; x_1^2\\
1 &amp; x_2 &amp; x_2^2\\
\vdots \\
1 &amp; x_n &amp; x_n^2\\
\end{pmatrix}
\end{gather}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{gather}
\mathbf{\epsilon}=
\begin{pmatrix}
\epsilon_1 \\
\epsilon_2 \\
\vdots \\
\epsilon_n \\
\end{pmatrix}
\end{gather}
\end{split}\]</div>
<p>So our system can now be expressed in matrix-vector form as</p>
<p><span class="math notranslate nohighlight">\(\mathbf{Y}=\mathbf{X}\mathbf{\beta}+\mathbf{\epsilon}\)</span> if we perfrom the same vector calculus as before we will end up with a result where pre-multiply by the transpose of <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> we will have a linear system in <span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span> which we can solve using Gaussian reduction, or LU decomposition or some other similar method.</p>
<p>The resulting system (that minimizes <span class="math notranslate nohighlight">\(\mathbf{\epsilon^T}\mathbf{\epsilon}\)</span>) is</p>
<p><span class="math notranslate nohighlight">\(\mathbf{X^T}\mathbf{Y}=\mathbf{X^T}\mathbf{X}\mathbf{\beta}\)</span> and solving for the parameters gives
<span class="math notranslate nohighlight">\(\mathbf{\beta}=(\mathbf{X^T}\mathbf{X})^{-1}\mathbf{X^T}\mathbf{Y}\)</span></p>
<p>So lets apply it to our example - what follows is mostly in python primative</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># linearsolver with pivoting adapted from </span>
<span class="c1"># https://stackoverflow.com/questions/31957096/gaussian-elimination-with-pivoting-in-python/31959226</span>
<span class="k">def</span> <span class="nf">linearsolver</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">A</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">M</span><span class="p">:</span>
     <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
     <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1"># row reduction with pivots</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
       <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k</span><span class="p">]):</span>
          <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
       <span class="k">else</span><span class="p">:</span>
          <span class="k">pass</span>

     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
         <span class="n">q</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
         <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">M</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">m</span><span class="p">]</span> <span class="o">-=</span>  <span class="n">q</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">m</span><span class="p">]</span>
<span class="c1"># allocate space for result</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="c1"># back-substitution</span>
    <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="p">])</span><span class="o">/</span><span class="n">M</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
          <span class="n">z</span> <span class="o">=</span> <span class="n">z</span>  <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
      <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
<span class="c1"># return result</span>
    <span class="k">return</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1">#######</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># matrix multiply script</span>
<span class="k">def</span> <span class="nf">mmult</span><span class="p">(</span><span class="n">amatrix</span><span class="p">,</span><span class="n">bmatrix</span><span class="p">,</span><span class="n">rowNumA</span><span class="p">,</span><span class="n">colNumA</span><span class="p">,</span><span class="n">rowNumB</span><span class="p">,</span><span class="n">colNumB</span><span class="p">):</span>
    <span class="n">result_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumB</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumA</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rowNumA</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">colNumB</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">colNumA</span><span class="p">):</span>
                <span class="n">result_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">result_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">amatrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">bmatrix</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">result_matrix</span><span class="p">)</span>
<span class="c1"># matrix vector multiply script</span>
<span class="k">def</span> <span class="nf">mvmult</span><span class="p">(</span><span class="n">amatrix</span><span class="p">,</span><span class="n">bvector</span><span class="p">,</span><span class="n">rowNumA</span><span class="p">,</span><span class="n">colNumA</span><span class="p">):</span>
    <span class="n">result_v</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumA</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rowNumA</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">colNumA</span><span class="p">):</span>
                <span class="n">result_v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">result_v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">amatrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">bvector</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">result_v</span><span class="p">)</span>

<span class="n">colNumX</span><span class="o">=</span><span class="mi">2</span> <span class="c1">#</span>
<span class="n">rowNumX</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>
<span class="n">xmatrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span>
<span class="n">xtransp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span>
<span class="n">yvector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">):</span>
    <span class="n">xmatrix</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
    <span class="n">xtransp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">irow</span><span class="p">]</span><span class="o">=</span><span class="n">sample_weight</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
    <span class="n">yvector</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>   <span class="o">=</span><span class="n">sample_length</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
<span class="n">xtx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span>
<span class="n">xty</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">xtx</span> <span class="o">=</span> <span class="n">mmult</span><span class="p">(</span><span class="n">xtransp</span><span class="p">,</span><span class="n">xmatrix</span><span class="p">,</span><span class="n">colNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">,</span><span class="n">colNumX</span><span class="p">)</span>
<span class="n">xty</span> <span class="o">=</span> <span class="n">mvmult</span><span class="p">(</span><span class="n">xtransp</span><span class="p">,</span><span class="n">yvector</span><span class="p">,</span><span class="n">colNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">)</span>

<span class="n">beta</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#solve XtXB = XtY for B</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">linearsolver</span><span class="p">(</span><span class="n">xtx</span><span class="p">,</span><span class="n">xty</span><span class="p">)</span> <span class="c1">#Solve the linear system</span>

<span class="n">slope</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#0.129</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 22.813</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="mi">580</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="mi">630</span>
<span class="nb">object</span> <span class="o">=</span> <span class="n">myline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="n">xlow</span><span class="p">,</span><span class="n">xhigh</span><span class="p">)</span>
<span class="n">xone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">xtwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">yone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">ytwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">charttitle</span> <span class="o">=</span><span class="s1">&#39;Length versus Weight for </span><span class="se">\n</span><span class="s1"> NASA CF0132 Fiber Reinforced Polymer&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Prediction Engine Model </span><span class="se">\n</span><span class="s1"> Slope =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; Intercept =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">makeAbear</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">sample_length</span><span class="p">,</span><span class="n">xone</span><span class="p">,</span><span class="n">yone</span><span class="p">,</span><span class="n">xtwo</span><span class="p">,</span><span class="n">ytwo</span><span class="p">,</span><span class="s1">&#39;Weight (g)&#39;</span><span class="p">,</span><span class="s1">&#39;Length (cm)&#39;</span><span class="p">,</span><span class="n">charttitle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_19_0.png" src="../../_images/lesson11_19_0.png" />
</div>
</div>
<div class="section" id="what-s-the-value-of-the-computational-linear-algebra">
<h4>What’s the Value of the Computational Linear Algebra ?<a class="headerlink" href="#what-s-the-value-of-the-computational-linear-algebra" title="Permalink to this headline">¶</a></h4>
<p>The value comes when we have more explainatory variables, and we may want to deal with curvature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make two lists</span>
<span class="n">yyy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">xxx</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1">#0.129</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 22.813</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">object</span> <span class="o">=</span> <span class="n">myline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="n">xlow</span><span class="p">,</span><span class="n">xhigh</span><span class="p">)</span>
<span class="n">xone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">xtwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">yone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">ytwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">charttitle</span> <span class="o">=</span><span class="s1">&#39;yyy versus xxx&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Prediction Engine Model </span><span class="se">\n</span><span class="s1"> Slope =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; Intercept =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">makeAbear</span><span class="p">(</span><span class="n">xxx</span><span class="p">,</span> <span class="n">yyy</span><span class="p">,</span><span class="n">xone</span><span class="p">,</span><span class="n">yone</span><span class="p">,</span><span class="n">xtwo</span><span class="p">,</span><span class="n">ytwo</span><span class="p">,</span><span class="s1">&#39;xxx&#39;</span><span class="p">,</span><span class="s1">&#39;yyy&#39;</span><span class="p">,</span><span class="n">charttitle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_21_0.png" src="../../_images/lesson11_21_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colNumX</span><span class="o">=</span><span class="mi">2</span> <span class="c1">#</span>
<span class="n">rowNumX</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xxx</span><span class="p">)</span>
<span class="n">xmatrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span>
<span class="n">xtransp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span>
<span class="n">yvector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">):</span>
    <span class="n">xmatrix</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
    <span class="n">xtransp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">irow</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
    <span class="n">yvector</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>   <span class="o">=</span><span class="n">yyy</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
<span class="n">xtx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span>
<span class="n">xty</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">xtx</span> <span class="o">=</span> <span class="n">mmult</span><span class="p">(</span><span class="n">xtransp</span><span class="p">,</span><span class="n">xmatrix</span><span class="p">,</span><span class="n">colNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">,</span><span class="n">colNumX</span><span class="p">)</span>
<span class="n">xty</span> <span class="o">=</span> <span class="n">mvmult</span><span class="p">(</span><span class="n">xtransp</span><span class="p">,</span><span class="n">yvector</span><span class="p">,</span><span class="n">colNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">)</span>

<span class="n">beta</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#solve XtXB = XtY for B</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">linearsolver</span><span class="p">(</span><span class="n">xtx</span><span class="p">,</span><span class="n">xty</span><span class="p">)</span> <span class="c1">#Solve the linear system</span>

<span class="n">slope</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#0.129</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 22.813</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">object</span> <span class="o">=</span> <span class="n">myline</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="n">intercept</span><span class="p">,</span><span class="n">xlow</span><span class="p">,</span><span class="n">xhigh</span><span class="p">)</span>
<span class="n">xone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">xtwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">yone</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span> <span class="n">ytwo</span> <span class="o">=</span> <span class="nb">object</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">charttitle</span> <span class="o">=</span><span class="s1">&#39;yyy versus xxx&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Prediction Engine Model </span><span class="se">\n</span><span class="s1"> Slope =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; Intercept =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">makeAbear</span><span class="p">(</span><span class="n">xxx</span><span class="p">,</span> <span class="n">yyy</span><span class="p">,</span><span class="n">xone</span><span class="p">,</span><span class="n">yone</span><span class="p">,</span><span class="n">xtwo</span><span class="p">,</span><span class="n">ytwo</span><span class="p">,</span><span class="s1">&#39;xxx&#39;</span><span class="p">,</span><span class="s1">&#39;yyy&#39;</span><span class="p">,</span><span class="n">charttitle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_22_0.png" src="../../_images/lesson11_22_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colNumX</span><span class="o">=</span><span class="mi">4</span> <span class="c1">#</span>
<span class="n">rowNumX</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xxx</span><span class="p">)</span>
<span class="n">xmatrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span>
<span class="n">xtransp</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span>
<span class="n">yvector</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rowNumX</span><span class="p">):</span>
    <span class="n">xmatrix</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
    <span class="n">xmatrix</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">xmatrix</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">xtransp</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">irow</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
    <span class="n">xtransp</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">irow</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">xtransp</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">irow</span><span class="p">]</span><span class="o">=</span><span class="n">xxx</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">yvector</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>   <span class="o">=</span><span class="n">yyy</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span>
<span class="n">xtx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colNumX</span><span class="p">)]</span>
<span class="n">xty</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">xtx</span> <span class="o">=</span> <span class="n">mmult</span><span class="p">(</span><span class="n">xtransp</span><span class="p">,</span><span class="n">xmatrix</span><span class="p">,</span><span class="n">colNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">,</span><span class="n">colNumX</span><span class="p">)</span>
<span class="n">xty</span> <span class="o">=</span> <span class="n">mvmult</span><span class="p">(</span><span class="n">xtransp</span><span class="p">,</span><span class="n">yvector</span><span class="p">,</span><span class="n">colNumX</span><span class="p">,</span><span class="n">rowNumX</span><span class="p">)</span>

<span class="n">beta</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#solve XtXB = XtY for B</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">linearsolver</span><span class="p">(</span><span class="n">xtx</span><span class="p">,</span><span class="n">xty</span><span class="p">)</span> <span class="c1">#Solve the linear system</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">howMany</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">xlow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">xhigh</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="p">(</span><span class="n">xhigh</span> <span class="o">-</span> <span class="n">xlow</span><span class="p">)</span><span class="o">/</span><span class="n">howMany</span>
<span class="n">xmodel</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ymodel</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">howMany</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">xnow</span> <span class="o">=</span> <span class="n">xlow</span> <span class="o">+</span> <span class="n">deltax</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">xmodel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xnow</span><span class="p">)</span>
    <span class="n">ymodel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">xnow</span><span class="o">+</span><span class="n">beta</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">xnow</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Now plot the sample values and plotting position</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> 
<span class="n">myfigure</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># generate a object from the figure class, set aspect ratio</span>

<span class="c1"># Built the plot</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xxx</span><span class="p">,</span> <span class="n">yyy</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xmodel</span><span class="p">,</span> <span class="n">ymodel</span><span class="p">,</span>  <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span> 
<span class="n">charttitle</span> <span class="o">=</span><span class="s1">&#39;yyy versus xxx&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Prediction Engine Model </span><span class="se">\n</span><span class="s1"> y =&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;x^2+&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;x +&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">2</span><span class="p">))</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">charttitle</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_24_0.png" src="../../_images/lesson11_24_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="now-using-numpy">
<h3>Now using numpy<a class="headerlink" href="#now-using-numpy" title="Permalink to this headline">¶</a></h3>
<p>Here we will repeat using numpy for the solver code should get identical results, lets get an example from the mighty internet and beat it into our original example above.</p>
<p>Taking the example from <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.lstsq.html">Here</a></p>
<p>Removing the narrative we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">])</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 1.]
 [1. 1.]
 [2. 1.]
 [3. 1.]]
0.9999999999999999 -0.9499999999999994
</pre></div>
</div>
<img alt="../../_images/lesson11_26_1.png" src="../../_images/lesson11_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Copy above, change x and y to our variables/design matrix</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sample_length</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#print(A)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.12890365448504984 22.812624584717575
</pre></div>
</div>
<img alt="../../_images/lesson11_27_1.png" src="../../_images/lesson11_27_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="exercises-in-class">
<h2>Exercises (In-Class)<a class="headerlink" href="#exercises-in-class" title="Permalink to this headline">¶</a></h2>
<div class="section" id="background">
<h3>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<p>Most drugs have therapeutic benefits when the drug is above a “therapeutic threshold” but toxic side effects above a “toxic threshold”. Dosing protocols are intended to maintain the level of the drug in the patient’s blood within a “therapeutic window” that between these two thresholds. Using mathematical models helps an engineer optimize the drug design so the entire delivery process is as efficient as possible and localized drug concentrations are kept within a therapeutic window.  Here you will test some mathematical models for just one part of this process - an in vitro experiment of drug release from a nanoparticle. (“Nanosystems for Simultaneous Imaging and Drug Delivery to T Cells”, by Fahmy et al, AAPS Journal, 2007 vol 9.). The experimental results are listed below</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Time(Days)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\mu\)</span>-grams released</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>2.5</p></td>
</tr>
<tr class="row-odd"><td><p>0.25</p></td>
<td><p>3.6</p></td>
</tr>
<tr class="row-even"><td><p>0.5</p></td>
<td><p>5.3</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>9.5</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>14.0</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>16.5</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>18.8</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>21.5</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>23.2</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>26.8</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>28.4</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Plot the drug release data with time on the horizontal axis, and mass released on the vertical axis. Use red circles as the marker.</p></li>
<li><p>Create and plot a linear data model using a blue curve for the model. <span class="math notranslate nohighlight">\(\mu g_{release} = \beta_0 + \beta_1 \cdot t_{days}\)</span></p></li>
<li><p>Create a list of prediction error; produce a histogram of these errors (called residuals).</p></li>
<li><p>Compute the sum of the squares of all of the residuals.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code here</span>
<span class="c1"># plotting function</span>

<span class="c1"># linear model function</span>

<span class="k">def</span> <span class="nf">funny</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">tttt2</span><span class="p">):</span>
    <span class="n">funny</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">tttt2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">funny</span><span class="p">)</span>

<span class="n">bac</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span>
<span class="mf">3.6</span><span class="p">,</span>
<span class="mf">5.3</span><span class="p">,</span>
<span class="mf">9.5</span><span class="p">,</span>
<span class="mi">14</span><span class="p">,</span>
<span class="mf">16.5</span><span class="p">,</span>
<span class="mf">18.8</span><span class="p">,</span>
<span class="mf">21.5</span><span class="p">,</span>
<span class="mf">23.2</span><span class="p">,</span>
<span class="mf">26.8</span><span class="p">,</span>
<span class="mf">28.4</span><span class="p">]</span>
<span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>
<span class="mf">0.25</span><span class="p">,</span>
<span class="mf">0.5</span><span class="p">,</span>
<span class="mi">1</span><span class="p">,</span>
<span class="mi">2</span><span class="p">,</span>
<span class="mi">3</span><span class="p">,</span>
<span class="mi">4</span><span class="p">,</span>
<span class="mi">5</span><span class="p">,</span>
<span class="mi">6</span><span class="p">,</span>
<span class="mi">8</span><span class="p">,</span>
<span class="mi">10</span><span class="p">]</span>
<span class="c1"># supply data</span>
<span class="c1"># build lists of observation</span>
<span class="c1"># build lists of model</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="c1"># Copy above, change x and y to our variables/design matrix</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bac</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#print(A)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">c</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">m</span>
<span class="n">bacmodel</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bac</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">bacmodel</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span> <span class="o">=</span> <span class="n">funny</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">irow</span><span class="p">])</span>

    
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">bac</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">bacmodel</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># build lists of observation</span>
<span class="c1"># build lists of model</span>
<span class="c1"># plot</span>
<span class="c1"># prediction residuals</span>
<span class="c1"># sum_of_squares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.6521827617787723 5.879612292663069
</pre></div>
</div>
<img alt="../../_images/lesson11_30_1.png" src="../../_images/lesson11_30_1.png" />
</div>
</div>
</div>
<div class="section" id="exercise-2">
<h3>Exercise-2<a class="headerlink" href="#exercise-2" title="Permalink to this headline">¶</a></h3>
<p>Using the drug release data, repeat your analysis using a 2-nd order polynomial data model</p>
<p><span class="math notranslate nohighlight">\(\mu g_{release} = \beta_0 + \beta_1 \cdot t_{days} + \beta_2 \cdot t_{days}^2 \)</span></p>
<ol class="simple">
<li><p>Perform your trial-and-error fit for this model. Report the sum of square of residuals of your fitted data model.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code here</span>
<span class="c1"># quadratic model function</span>
<span class="k">def</span> <span class="nf">funnyhaha</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">cc</span><span class="p">,</span><span class="n">tttt2</span><span class="p">):</span>
    <span class="n">funnyhaha</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">tttt2</span><span class="o">+</span><span class="n">cc</span><span class="o">*</span><span class="p">(</span><span class="n">tttt2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">funnyhaha</span><span class="p">)</span>
<span class="c1"># build lists of model</span>
<span class="c1"># plot</span>
<span class="c1"># prediction residuals</span>
<span class="c1"># Copy above, change x and y to our variables/design matrix</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="c1"># print(xx)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bac</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#print(A)</span>
<span class="n">cc</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># sum_of_squares</span>
<span class="n">bacmodel</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bac</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">bacmodel</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span> <span class="o">=</span> <span class="n">funnyhaha</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">cc</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">irow</span><span class="p">])</span>

    
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">bac</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">bacmodel</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># build lists of observation</span>
<span class="c1"># build lists of model</span>
<span class="c1"># plot</span>
<span class="c1"># prediction residuals</span>
<span class="c1"># sum_of_squares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_32_0.png" src="../../_images/lesson11_32_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="exercise-3">
<h2>Exercise-3<a class="headerlink" href="#exercise-3" title="Permalink to this headline">¶</a></h2>
<p>Using the drug release data, repeat your analysis using a 3-rd order polynomial data model</p>
<p><span class="math notranslate nohighlight">\(\mu g_{release} = \beta_0 + \beta_1 \cdot t_{days} + \beta_2 \cdot t_{days}^2 + \beta_3 \cdot t_{days}^3\)</span></p>
<ol class="simple">
<li><p>Perform your trial-and-error fit. Report the sum of square of residuals of your fitted data model.</p></li>
<li><p>What is the order of the polynomial that gives the best fit in terms of the lowest sum of square of residuals?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code here</span>
<span class="c1"># cubic model function</span>
<span class="c1"># code here</span>
<span class="c1"># quadratic model function</span>
<span class="k">def</span> <span class="nf">funnylol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">cc</span><span class="p">,</span><span class="n">ccc</span><span class="p">,</span><span class="n">tttt2</span><span class="p">):</span>
    <span class="n">funnylol</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">tttt2</span><span class="o">+</span><span class="n">cc</span><span class="o">*</span><span class="p">(</span><span class="n">tttt2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">ccc</span><span class="o">*</span><span class="p">(</span><span class="n">tttt2</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">funnylol</span><span class="p">)</span>
<span class="c1"># build lists of model</span>
<span class="c1"># plot</span>
<span class="c1"># prediction residuals</span>
<span class="c1"># Copy above, change x and y to our variables/design matrix</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="n">xxx</span> <span class="o">=</span><span class="n">xx</span><span class="o">*</span><span class="n">x</span>
<span class="c1"># print(xx)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bac</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xxx</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>
<span class="c1">#print(A)</span>
<span class="n">ccc</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># sum_of_squares</span>
<span class="n">bacmodel</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bac</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">bacmodel</span><span class="p">[</span><span class="n">irow</span><span class="p">]</span> <span class="o">=</span> <span class="n">funnylol</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">cc</span><span class="p">,</span><span class="n">ccc</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">irow</span><span class="p">])</span>

    
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">bac</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">bacmodel</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># build lists of observation</span>
<span class="c1"># build lists of model</span>
<span class="c1"># plot</span>
<span class="c1"># prediction residuals</span>
<span class="c1"># sum_of_squares</span>
<span class="c1"># build lists of model</span>
<span class="c1"># plot</span>
<span class="c1"># prediction residuals</span>
<span class="c1"># sum_of_squares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_34_0.png" src="../../_images/lesson11_34_0.png" />
</div>
</div>
</div>
<div class="section" id="exercise-4">
<h2>Exercise-4<a class="headerlink" href="#exercise-4" title="Permalink to this headline">¶</a></h2>
<p>Using the drug release data, repeat your analysis using an exponential-decay type model</p>
<p><span class="math notranslate nohighlight">\(\mu g_{release} = \beta_0 (1- e^{-\beta_1 \cdot t_{days}}) \)</span></p>
<ol class="simple">
<li><p>Perform your trial-and-error fit for this model. Report the sum of square of residuals of your fitted data model.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This cannot be solved by linear regression - the form of the prototype is indeed non-linear, however a useful rule of thumb for this kind of structure is:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_0\)</span> is roughly the horizontal asymptote, in our case around 33 (an educated guess).</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1\)</span> is an exponential decay time constant, roughly 5 time constants should get us to within 10% the asymptote.  In the data herein, we get our asymptote at 10 time units. So <span class="math notranslate nohighlight">\(\beta_1\)</span> should be around <span class="math notranslate nohighlight">\(\frac{1}{5}\)</span></p></li>
</ol>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code here</span>
<span class="c1"># exponential decay model function</span>
<span class="k">def</span> <span class="nf">hhaa</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">math</span>
    <span class="n">hhaa</span><span class="o">=</span><span class="n">b1</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b2</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">hhaa</span><span class="p">)</span>

<span class="n">b1</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="n">b2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mf">3.65</span><span class="p">)</span> 
<span class="n">bactmodel</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">bactmodel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">hhaa</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">bac</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">bactmodel</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1"># build lists of model</span>
<span class="c1"># plot</span>
<span class="c1"># prediction residuals</span>
<span class="c1"># sum_of_squares</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_36_0.png" src="../../_images/lesson11_36_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="mf">0.275</span><span class="p">)</span>
<span class="mi">1</span><span class="o">/.</span><span class="mi">275</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.6363636363636362
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-5">
<h2>Exercise-5<a class="headerlink" href="#exercise-5" title="Permalink to this headline">¶</a></h2>
<p>Which of the drug-release models do you like best?  Why?  The parameters in the exponential-decay model have bio-chemical conceptual meaning.  What is the significance of <span class="math notranslate nohighlight">\(\beta_0\)</span> in this model? (Consider what happens as time gets large)</p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="change-to-markdown-and-write-your-answer">
<h1>change to markdown and write your answer<a class="headerlink" href="#change-to-markdown-and-write-your-answer" title="Permalink to this headline">¶</a></h1>
<p>We heart 5</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_0 = 30\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_1 = \frac{1}{3.65}\)</span></p></li>
</ol>
<div class="section" id="exercise-5-continued">
<h2>Exercise-5 (continued)<a class="headerlink" href="#exercise-5-continued" title="Permalink to this headline">¶</a></h2>
<p>Using your favorite data model predict the drug release for days 11-21 inclusive.  Compare your predictions to observations reported from the drug trials below:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Time(Days)</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\mu\)</span>-grams released</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>12</p></td>
<td><p>28.4</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>28.5</p></td>
</tr>
<tr class="row-even"><td><p>21</p></td>
<td><p>29.5</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code here</span>
<span class="c1"># add new data to observations</span>
<span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="n">bac</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">28.4</span><span class="p">)</span>
<span class="n">bac</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">28.5</span><span class="p">)</span>
<span class="n">bac</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">29.5</span><span class="p">)</span>

<span class="c1"># use favorite model function with already determined parameters</span>
<span class="c1"># build lists of model</span>
<span class="n">bactmodel</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">bactmodel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">hhaa</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="c1"># plot</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">bac</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original data&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">bactmodel</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted line&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># compute prediction error </span>
<span class="n">prederr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">prederr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">bac</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">bactmodel</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="c1"># plot</span>
<span class="c1"># report error for 12,16,21 days values</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">prederr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson11_41_0.png" src="../../_images/lesson11_41_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 6.25
0.25 2.604982052254526
0.5 2.1300384666966017
1 5.338813194293575
2 1.8065947978627535
3 0.09757250872140341
4 1.3753288324107593
5 0.7669325745537564
6 1.0057622164330766
8 0.022960936396191733
10 0.11400157634652329
12 0.23018771522560172
16 1.266919501284283
21 0.16389786666657066
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="concrete-strength-database">
<h2>Concrete Strength Database<a class="headerlink" href="#concrete-strength-database" title="Permalink to this headline">¶</a></h2>
<p>Now lets examine the concrete database again and see what kind of prediction engine we can come up with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Get database -- use the Get Data From URL Script</span>
<span class="c1">#Step 1: import needed modules to interact with the internet</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="c1">#Step 2: make the connection to the remote file (actually its implementing &quot;bash curl -O http://fqdn/path ...&quot;)</span>
<span class="n">remote_url</span> <span class="o">=</span> <span class="s1">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/concrete/compressive/Concrete_Data.xls&#39;</span> <span class="c1"># an Excel file</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">remote_url</span><span class="p">)</span> <span class="c1"># Gets the file contents puts into an object</span>
<span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;concreteData.xls&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="c1"># Prepare a destination, local</span>
<span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span> <span class="c1"># write contents of object to named local file</span>
<span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># close the connection</span>
</pre></div>
</div>
</div>
</div>
<p>Import/install support packages (if install required, either on your machine, or contact network admin to do a root install)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The usual suspects plus some newish ones!</span>
<span class="c1">### Import/install support packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> 
<span class="c1">#%matplotlib inline</span>
</pre></div>
</div>
</div>
</div>
<p>Now try to read the file, use pandas methods</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s2">&quot;concreteData.xls&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>lorem ipsum</p>
<p>lorem ipsum</p>
</div>
<div class="section" id="topic">
<h2>topic<a class="headerlink" href="#topic" title="Permalink to this headline">¶</a></h2>
<div class="section" id="subtopic">
<h3>Subtopic<a class="headerlink" href="#subtopic" title="Permalink to this headline">¶</a></h3>
<p>lorem ipsum</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Chan, Jamie. Machine Learning With Python For Beginners: A Step-By-Step Guide with Hands-On Projects (Learn Coding Fast with Hands-On Project Book 7) (p. 2). Kindle Edition.</p></li>
</ol>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lessons/lesson11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../optimization/3topic.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Gradient Descent Methods</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="regressionModels.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Linear Regression using packages</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Theodore G. Cleveland<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>